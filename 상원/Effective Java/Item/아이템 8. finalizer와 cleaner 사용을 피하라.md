## 아이템 8. finalizer 와 cleaner 사용을 피하라

자바는 두 가지 객체 소멸자를 제공한다.

finalizer 는 예측할 수 없고, 상황에 따라 위험할 수 있어 일반적으로 불필요하다.

cleaner 는 finalizer 보다는 덜 위험하지만, 여전히 예측할 수 없고, 느리고, 일반적으로 불필요하다.

cleaner, finalizer 모두 즉시 수행된다는 보장이 없기 때문에 제때 실행되어야하는 작업은 절대 할 수 없으며, 상태를 영구적으로 수정하는 작업에는 절대 의존해서는 안된다.

또한 심각한 성능 문제도 동반하며 finalizer 를 사용한 클래스는 finalizer 공격에 노출되어 심각한 보안 문제를 일으킬 수 있다.

`final`이 아닌 클래스를 finalizer 공격으로부터 방어하러면 아무 일도 하지 않는 finalize 메세드를 만들고 `final`로 선언 하자.

cleaner, finalizer 를 사용할 수 있는 적절한 경우

1. 자원의 소유자가 close 메서드를 호출하지 않는 것에 대비한 안전망 역할
    - cleaner 나 finalizer 가 즉시 호출되리라는 보장은 없지만, 클라이언트가 하지 않은 자원회수를 늦게라도 해주는 것이 아예 안 하는 것보다는 낫기 때문이다.
    - `FileInputStream`, `FileOutputStream`, `ThreadPoolExecutor` 가 대표적인 클래스이다.
    
2. 네이티브 피어와 연결된 객체에서다.
   - 네이티브 피어란 일반 자바 객체가 네이티브 메서드를 통해 기능을 위임한 네이티브 객체를 말한다.
   - 네이티브 피어는 Java 객체가 아니기 때문에 가비지 컬렉터가 그 존재를 알지 못하고, Java 객체를 회수할 때 네이티브 객체까지 회수하지 못한다.
   - `finalizer` , `cleaner` 가 수행하기 적합한 작업이지만 성능 저하를 감당할 수 있고 네이티브 피어가 심각한 자원을 가지고 있지 않을 때에만 해당된다.
   - 성능 저하를 감당할 수 없거나 네이티브 피어의 자원을 즉시 회수해야하는 경우 `close` 메서드를 사용하는 것이 좋다.

